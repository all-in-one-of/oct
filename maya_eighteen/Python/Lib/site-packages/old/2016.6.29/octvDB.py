def listDB(db):
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	b = cur.execute("select * from " + db)
	for i in b:
		print i
	
def queryCheckUserDB(db, fname):
	checkUser = ()
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	b = cur.execute("select checkUser from " + db + " WHERE name= '" + fname + "'")
	for i in b:
		checkUser = i
		break

#	if len(b.fetchall())>0:
#		checkstate = 1

	return checkUser
		
def queryCheckoutStateDB(db, fname):
	checkUser = ()
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	b = cur.execute("select checkStatue from " + db + " WHERE name= '" + fname + "'")
	for i in b:
		checkUser = i
		break

	return checkUser

def delDB(db, fname):
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	cur.execute("DELETE FROM " + db + " WHERE name= '" + fname + "'")
	cur.commit()

def insertDB(db, fname, fstate, ftype, upUser, fpath, checkState, checkUser,desc):
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
#	cur.execute("INSERT INTO " + db + " VALUES('" + materialId + "','" + fname + "','" + fstate + "','" + ftype + "','" + upTime + "','" + upUser + "','" + fpath + "','" + checkState + "','" + checkUser + "')")
	#inst="INSERT INTO " + db  + "(name, statue, type, upTime, upUser, path, checkStatue, checkUser, memo) " + " VALUES('" + fname + "','" + fstate + "','" + ftype + "',GETDATE(),'" + upUser + "','" + fpath + "','" + checkState + "','" + checkUser  + "','" + desc + "')select GETDATE()"
	#print inst
	cur.execute("INSERT INTO " + db  + "(name, statue, type, upTime, upUser, path, checkStatue, checkUser, memo) " + " VALUES('" + fname + "','" + fstate + "','" + ftype + "',GETDATE(),'" + upUser + "','" + fpath + "','" + checkState + "','" + checkUser  + "','" + desc + "')select GETDATE()")
	cur.commit()

def setCheckUserUNLLDB(db,fname):
	import pypyodbc
	con=pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	cur.execute("UPDATE " + db + " SET checkUser = '' WHERE name= '" + fname + "'")
	cur.commit()
	cur.close()

def insertAssertDB(db,fileName,httpUrl,projectName,seriers,assetOrAnimSQLVal,bigType,procType):
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	cur.execute("INSERT INTO " + db  + "(fileName, httpUrl, projectName, seriers, assetOrAnimSQLVal, bigType, procType, upTime) " + " VALUES('" + fileName + "','" + httpUrl + "','" + projectName + "','" + seriers + "','" + assetOrAnimSQLVal + "','" + bigType + "','" + procType + "',GETDATE())")
	cur.commit()

def insertAnimationDB(db,fileName,httpUrl,projectName,sc,sh,assetOrAnimSQLVal,bigType,procType):
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	cur.execute("INSERT INTO " + db  + "(fileName, httpUrl, projectName, sc, sh, assetOrAnimSQLVal, bigType, procType, upTime) " + " VALUES('" + fileName + "','" + httpUrl + "','" + projectName + "','" + sc + "','" + sh + "','" + assetOrAnimSQLVal + "','" + bigType + "','" + procType  +  "',GETDATE())")
	cur.commit()

def delTextureDB(db, fname):
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	cur.execute("DELETE FROM " + db + " WHERE fileName= '" + fname + "'")
	cur.commit()

def queryDB(db, fname):
	checkUser = ()
	import pypyodbc
	con = pypyodbc.connect('driver={SQL Server};server=192.168.80.200;port=1433;uid=sa;pwd=123.com;database=yshubpm')
	cur = con.cursor()
	b = cur.execute("select * from " + db + " WHERE name= '" + fname + "'")
	for i in b:
		checkUser = i
		break
	return checkUser

